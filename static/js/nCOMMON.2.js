"use strict";var nCONSOLE={f_log:true};nCONSOLE.get_line=function(){function _get_error(){try{throw new Error();}catch(err){return err}}var v_stack=_get_error().stack.split('\n');var v_res={name:'???',file:'???',line:-1,pos:-1};if(v_stack.length>=4){var v_r1=v_stack[3].match(/^(.*?)@(.*):(\d+):(\d+)$/);if(v_r1){v_res.name=v_r1[1];v_res.file=v_r1[2];v_res.line=parseInt(v_r1[3],10);v_res.pos=parseInt(v_r1[4],10)}}return v_res};nCONSOLE.log=function(){if(nCONSOLE.f_log){var v_ptr=nCONSOLE.get_line();var v_no=arguments.length;arguments[v_no]=v_ptr;arguments.length++;console.log.apply(console,arguments)}};nCONSOLE.off=function(){nCONSOLE.f_log=false};nCONSOLE.on=function(){nCONSOLE.f_log=true};var nCOMMON={workarea:'',units_show_format:'tile',show_btn_up:false,lang:'ru',const:{KiB:1024,MiB:1024*1024,GiB:1024*1024*1024,mon_nm1:['Январь','Февраль','Март','Апрель','Май','Июнь','Июль','Август','Сентябрь','Октябрь','Ноябрь','Декабрь'],mon_nm2:['Января','Февраля','Марта','Апреля','Мая','Июня','Июля','Августа','Сентября','Октября','Ноября','Декабря'],day_nm:['Пн','Вт','Ср','Чт','Пт','Сб','Вс'],sizes:{en:{KiB:'KiB',MiB:'MiB',GiB:'GiB',B:'bytes'},ru:{KiB:'Киб',MiB:'Миб',GiB:'Гиб',B:'байт'}}},format:{date:'yyyy.mm.dd',date_time:'yyyy.mm.dd HH:MM',date_time_undef:'????.??.?? ??:??',date_time_empty:'0000.00.00 00:00',date_time2:'yyyy.mm.dd HH:MM:ss',date_time_undef2:'????.??.?? ??:??:??',date_time_empty2:'0000.00.00 00:00:00',date_undef:'????.??.??',date_empty:'0000.00.00'},_dummy_:null};nCOMMON.current_unix_time=function(){return Math.ceil(new Date()/1000)};nCOMMON.ymd2unix=function(p_date){return Math.ceil(new Date(p_date)/1000)};nCOMMON.funix2date=function(p_unix_time){if(p_unix_time===undefined){return nCOMMON.format.date_undef}if(p_unix_time===null){return nCOMMON.format.date_undef}return(new Date(p_unix_time*1000)).format(nCOMMON.format.date)};nCOMMON.funix2datetime=function(p_unix_time){if(p_unix_time===undefined){return nCOMMON.format.date_time_undef}if(p_unix_time===null){return nCOMMON.format.date_time_undef}return(new Date(p_unix_time*1000)).format(nCOMMON.format.date_time)};nCOMMON.funix2datetime2=function(p_unix_time){if(p_unix_time===undefined){return nCOMMON.format.date_time_undef2}if(p_unix_time===null){return nCOMMON.format.date_time_undef2}return(new Date(p_unix_time*1000)).format(nCOMMON.format.date_time2)};nCOMMON.fdatetime=function(p_datetime){if(p_datetime===undefined){return nCOMMON.format.date_undef}if(p_datetime===null){return nCOMMON.format.date_undef}if(p_datetime===0){return nCOMMON.format.date_empty}return(new Date(p_datetime*1000)).format(nCOMMON.format.date)};nCOMMON.fsize=function(p_size){if(p_size>=nCOMMON.const.GiB){return(p_size/nCOMMON.const.GiB).toFixed(1).toString()+' '+nCOMMON.const.sizes[nCOMMON.lang].GiB}if(p_size>=nCOMMON.const.MiB){return(p_size/nCOMMON.const.MiB).toFixed(1).toString()+' '+nCOMMON.const.sizes[nCOMMON.lang].MiB}if(p_size>=10*nCOMMON.const.KiB){return(p_size/nCOMMON.const.KiB).toFixed(1).toString()+' '+nCOMMON.const.sizes[nCOMMON.lang].KiB}return p_size.toString()+' '+nCOMMON.const.sizes[nCOMMON.lang].B};nCOMMON.show=function(p_href,p_trigger_on){if(nCOMMON.workarea){ $(nCOMMON.workarea).hide()}nCOMMON.workarea='#'+p_href;var v_wa=$(nCOMMON.workarea);v_wa.show(); $('#navbar div a').removeClass('navbar-item-current');var v_item=$('#navbar div a[href="/#p/'+p_href+'"]');v_item.addClass('navbar-item-current');if(p_trigger_on===undefined||p_trigger_on){v_wa.trigger('open')}};nCOMMON.is_show=function(p_href){if(nCOMMON.workarea==='#'+p_href){return true}return false};nCOMMON.to_ref=function(p_ref){var v_res=/^.*?#p\/([-a-z0-9_]+)(.*)$/.exec(p_ref);if(v_res){nCOMMON.set_hash('#p/'+v_res[1]+v_res[2]);nCOMMON.show(v_res[1])}else{window.location.hash='#p/main';nCOMMON.show('main')}};nCOMMON.parse_ref=function(p_ref){if(p_ref===undefined){p_ref=window.location.hash}p_ref=decodeURI(p_ref);var v_res=/^.*?#([^?]+)\?*(.*)$/.exec(p_ref);if(v_res){var v_items=v_res[1].split('/');v_res[1]=v_items;var v_args=v_res[2].split('&');v_res[2]={};for(var v_i=0;v_i<v_args.length;v_i++){if(/^\s*$/.test(v_args[v_i])){continue}var v_arg=v_args[v_i].split('=');v_res[2][v_arg[0]]=typeof v_arg[1]==='undefined'?{t:0}:{t:1,v:v_arg[1]}}}return v_res};nCOMMON.build_ref=function(p_res){var v_ref='#';if(p_res){var v_items=p_res[1].join('/');v_ref+=v_items;var v_args=[];for(var v_k in p_res[2]){v_args.push(v_k+(p_res[2][v_k].t===1?'='+p_res[2][v_k].v:''))}if(v_args.length){v_ref+='?'+v_args.join('&')}}return encodeURI(v_ref)};nCOMMON.isArray=function(p_ref){return Object.prototype.toString.call(p_ref)==='[object Array]'};nCOMMON.isHash=function(p_ref){return Object.prototype.toString.call(p_ref)==='[object Object]'};nCOMMON.isString=function(p_ref){return Object.prototype.toString.call(p_ref)==='[object String]'};nCOMMON.isNumber=function(p_ref){return Object.prototype.toString.call(p_ref)==='[object Number]'};nCOMMON.build_query=function(p_params){var v_query=[];for(var v_k in p_params){if(nCOMMON.isArray(p_params[v_k])){var v_items=[];for(var v_i=0;v_i<p_params[v_k].length;v_i++){v_items.push(escape(p_params[v_k][v_i]))}v_query.push(v_k+'='+v_items.join(','));continue}v_query.push(v_k+'='+escape(p_params[v_k]))}return v_query.join('&')};nCOMMON.set_hash=function(p_hash){window.location.hash=p_hash};nCOMMON.check_new=function(p_params){var v_params={Class:'check','data-val':p_params.val};if(p_params.label===undefined){v_params.html='<span class="check-label">'+p_params.val+'</span>'}else{v_params.html='<span class="check-label">'+p_params.label+'</span>'}if(p_params.id!==undefined){v_params.id=p_params.id}if(p_params.style!==undefined){v_params.style=p_params.style}var v_item=$('<div/>',v_params);if(p_params.checked){v_item.prepend($('<span/>',{Class:"typcn typcn-tick"}))}else{v_item.addClass('check-off');v_item.prepend($('<span/>',{Class:"typcn typcn-tick-outline"}))}return v_item};nCOMMON.check_value=function(p_ref,p_value){if(p_value===undefined){return $(p_ref).data('val')} $(p_ref).data('val',p_value)};nCOMMON.check_label=function(p_ref,p_label){if(p_label===undefined){return $(p_ref).find('.check-label').html()}return $(p_ref).find('.check-label').html(p_label)};nCOMMON.check_toggle=function(p_item){var v_item=$(p_item);if(nCOMMON.check_is_on(v_item)){nCOMMON.check_off(v_item)}else{nCOMMON.check_on(v_item)}};nCOMMON.check_test=function(p_item){return!$(p_item).is('.check-off')};nCOMMON.check_is_on=function(p_item){return!$(p_item).is('.check-off')};nCOMMON.check_is_off=function(p_item){return $(p_item).is('.check-off')};nCOMMON.check_on=function(p_item){var v_item=$(p_item);if(nCOMMON.check_is_off(v_item)){v_item.removeClass('check-off');v_item.find('span:first').removeClass('typcn-tick-outline').addClass('typcn-tick')}};nCOMMON.check_off=function(p_item){var v_item=$(p_item);if(nCOMMON.check_is_on(v_item)){v_item.addClass('check-off');v_item.find('span:first').removeClass('typcn-tick').addClass('typcn-tick-outline')}};nCOMMON.req_error=function(p_res){alert('ОШИБКА ВЫПОЛНЕНИЯ ЗАПРОСА:\n'+p_res.msg.join('\n')+(p_res.rc?'\n\nКод ошибки:'+p_res.rc:''))};nCOMMON.default={currency:null};nCOMMON.currency=function(p_val,p_default){if(p_val===undefined){return(p_default===undefined?nCOMMON.default.currency:p_default)}var v_num=p_val.replace(/\s+/g,'');v_num=v_num.replace(/,/,'.');if(/^-?[0-9]+(\.[0-9]*)?$/.test(v_num)){return Number(v_num)}return(p_default===undefined?nCOMMON.default.currency:p_default)};nCOMMON.get_value=function(p_val){var v_res={};if(p_val===undefined){return v_res}p_val=p_val.replace(/\s+/g,'');var v_powers=/^(\S+?)\s*(\.\.|-|‒|–|—|―|…)\s*(\S+?)$/.exec(p_val);if(v_powers){v_res.min=nCOMMON.currency(v_powers[1]);v_res.max=nCOMMON.currency(v_powers[3])}else{v_powers=p_val.split('/');if(v_powers.length===1){v_res.val=nCOMMON.currency(v_powers[0])}else{v_res.list=[];for(var v_i=0;v_i<v_powers.length;v_i++){v_res.list.push(nCOMMON.currency(v_powers[v_i]))}}}return v_res};nCOMMON.get_ui_vals=function(p_inp,p_error){var v_inp=$(p_inp);if(p_inp.length===0){if(v_errors&&typeof p_error==='function'){console.log('nCOMMON.get_uf_vals.010E',p_inp);p_error(p_inp)}return Number.NaN}var v_str=v_inp.val().trim().replace(/\s+/g,'');var v_res={};var v_errors=false;var v_check=/^\d+$/;if(v_check.test(v_str)){return{val:Number(v_str)}}if(v_str===''){return{val:null}}var v_vals=/^(\d+)(\.\.|…)(\d+)$/.exec(v_str);if(v_vals){if(v_check.test(v_vals[1])){v_res.min=Number(v_vals[1])}else{v_errors=true}if(v_check.test(v_vals[3])){v_res.max=Number(v_vals[3])}else{v_errors=true}if(v_errors&&typeof p_error==='function'){console.log('nCOMMON.get_uf_vals.020E',v_str);p_error(p_inp)}return v_res}v_vals=v_str.split('/');v_res.list=[];for(var v_i=0;v_i<v_vals.length;v_i++){if(v_check.test(v_vals[v_i])){v_res.list.push(Number(v_vals[v_i]))}else{v_errors=true;break}}if(v_errors&&typeof p_error==='function'){console.log('nCOMMON.get_uf_vals.030E',v_str);p_error(p_inp)}return v_res};nCOMMON.get_uf_vals=function(p_inp,p_error){var v_inp=$(p_inp);if(v_inp.length===0){if(v_errors&&typeof p_error==='function'){console.log('nCOMMON.get_uf_vals.010E',p_inp);p_error(undefined,p_inp)}return Number.NaN}var v_str=v_inp.val().trim().replace(/\s+/g,'').replace(',','.');if(/^\s*$/.test(v_str)){return null}var v_res={};var v_errors=false;var v_check=/^(\d+|\d+\.\d+|\d+\.|\.\d+)$/;if(v_check.test(v_str)){return{val:Number(v_str)}}let v_vals=/^(\S+)(\.\.|…)(\S+)$/.exec(v_str);if(v_vals){if(v_check.test(v_vals[1])){v_res.min=Number(v_vals[1])}else{v_errors=true}if(v_check.test(v_vals[3])){v_res.max=Number(v_vals[3])}else{v_errors=true}if(v_errors&&typeof p_error==='function'){console.log('nCOMMON.get_uf_vals.020E',v_str);p_error(v_str,p_inp)}}v_vals=v_str.split('/');v_res.list=[];for(var v_i=0;v_i<v_vals.length;v_i++){if(v_check.test(v_vals[v_i])){v_res.list.push(Number(v_vals[v_i]))}else{v_errors=true;break}}if(v_errors&&typeof p_error==='function'){console.log('nCOMMON.get_uf_vals.030E',p_inp,v_str);p_error(p_inp,v_str)}return v_res};nCOMMON.fixed_ru=function(p_val,p_digs){if(p_val===undefined){return'?,??'}if(Number.isNaN(p_val)){return'*,**'}if(p_val===null){return''}return(p_digs===undefined?p_val.toString().replace(".",','):p_val.toFixed(p_digs).replace(".",','))};nCOMMON.put_value=function(p_val,p_ratio){if(p_val===undefined){return'?,??'}if(p_val===null){return''}if(p_ratio===undefined){p_ratio=1}if(p_val.val!==undefined){if(p_val.val===null){return''}return nCOMMON.fixed_ru(p_val.val/p_ratio)}if(p_val.min!==undefined){if((p_val.min===0)&&(p_val.max===0)){if(p_val.rated!==undefined){return nCOMMON.fixed_ru(p_val.rated/p_ratio)}}if(p_val.rated){return nCOMMON.fixed_ru(p_val.min/p_ratio)+'..'+nCOMMON.fixed_ru(p_val.max/p_ratio)+'('+nCOMMON.fixed_ru(p_val.rated/p_ratio)+')'}return nCOMMON.fixed_ru(p_val.min/p_ratio)+'..'+nCOMMON.fixed_ru(p_val.max/p_ratio)}if(p_val.list!==undefined){var v_list=[];for(var v_i=0;v_i<p_val.list.length;v_i++){v_list.push(nCOMMON.fixed_ru(p_val.list[v_i]/p_ratio))}return v_list.join('/')}return'?,??'};nCOMMON.put_vals=function(p_val,p_ratio){if(p_val===undefined){return'?,??'}if(p_val===null){return''}if(p_ratio===undefined){p_ratio=1}if(typeof p_val==='number'){return nCOMMON.fixed_ru(p_val/p_ratio)}if(typeof p_val==='string'){return nCOMMON.fixed_ru(Number(p_val)/p_ratio)}if(p_val.val!==undefined){if(p_val.val===null){return''}return nCOMMON.fixed_ru(p_val.val/p_ratio)}if(p_val.min!==undefined){if((p_val.min===0)&&(p_val.max===0)){if(p_val.rated!==undefined){return nCOMMON.fixed_ru(p_val.rated/p_ratio)}}if(p_val.rated){return nCOMMON.fixed_ru(p_val.min/p_ratio)+'..'+nCOMMON.fixed_ru(p_val.max/p_ratio)+'('+nCOMMON.fixed_ru(p_val.rated/p_ratio)+')'}return nCOMMON.fixed_ru(p_val.min/p_ratio)+'..'+nCOMMON.fixed_ru(p_val.max/p_ratio)}if(p_val.list!==undefined){var v_list=[];for(var v_i=0;v_i<p_val.list.length;v_i++){v_list.push(nCOMMON.fixed_ru(p_val.list[v_i]/p_ratio))}return v_list.join('/')}return'?,??'};nCOMMON.get_uint=function(p_ref,p_err){p_ref=$(p_ref);if(p_ref.length===0){return null}var v_val=p_ref.val().trim();if(/^\s*$/.test(v_val)){return null}if(/^\d+$/.test(v_val)){return Number(v_val)}if(typeof p_err==='function'){return p_err(p_ref,v_val)}return Number.NaN};nCOMMON.get_ui=nCOMMON.get_uint;nCOMMON.get_sint=function(p_ref,p_err){p_ref=$(p_ref);if(p_ref.length===0){return null}var v_val=p_ref.val().trim();if(/^\s*$/.test(v_val)){return null}if(/^[-+]*\d+$/.test(v_val)){return Number(v_val)}if(typeof p_err==='function'){return p_err(p_ref,v_val)}return Number.NaN};nCOMMON.get_si=nCOMMON.get_sint;nCOMMON.get_fixed=function(p_ref,p_err){p_ref=$(p_ref);if(p_ref.length===0){return null}var v_val=p_ref.val().trim();if(/^\s*$/.test(v_val)){return null}v_val=v_val.toString().replace(',','.');if(/^\d+$/.test(v_val)){return Number(v_val)}if(/^\d+(\.\d*)$/.test(v_val)){return Number(v_val)}if(/^\.\d+$/.test(v_val)){return Number(v_val)}if(typeof p_err==='function'){return p_err(p_ref,v_val)}return Number.NaN};nCOMMON.get_uf=nCOMMON.get_fixed;nCOMMON.get_signed_fixed=function(p_ref,p_err){p_ref=$(p_ref);if(p_ref.length===0){return null}var v_val=p_ref.val().trim();if(/^\s*$/.test(v_val)){return null}v_val=v_val.toString().replace(',','.');if(/^-?\d+$/.test(v_val)){return Number(v_val)}if(/^-?\d+(\.\d*)$/.test(v_val)){return Number(v_val)}if(/^-?\.\d+$/.test(v_val)){return Number(v_val)}if(typeof p_err==='function'){return p_err(p_ref,v_val)}return Number.NaN};nCOMMON.get_sf=nCOMMON.get_signed_fixed;nCOMMON.get_fixed_minmax=function(p_ref,p_err){p_ref=$(p_ref);var v_val=p_ref.val().trim();if(/^\s*$/.test(v_val)){return null}var v_res=/^(.*?)(\/|\.\.|-)(.*)$/.exec(v_val);if(v_res){var v_min=nCOMMON.get_fixed(v_res[1],p_err);var v_max=nCOMMON.get_fixed(v_res[2],p_err);if(isNaN(v_min)||isNaN(v_max)){return Number.NaN}return{min:v_min,max:v_max}}return nCOMMON.get_fixed(p_ref,p_err)};nCOMMON.nvl=function(p_val1,p_val2){if(p_val1===undefined){return p_val2}if(p_val1){return p_val2}return p_val1};nCOMMON.nvlz=function(p_val1,p_val2){return(p_val1?p_val1:p_val2)};nCOMMON.open_url_in_tab=function(p_url){if(!nCOMMON._form){nCOMMON._form=$('<form/>',{target:'_blank',method:'GET'}); $('body').append(nCOMMON._form)}nCOMMON._form.attr('action',p_url);nCOMMON._form.submit()};(function(){"use strict";if(typeof window.nAJAX!=='undefined'){console.error("Redefined window.nAJAX");throw"nAJAX.100";}window.nAJAX={};nAJAX._init=function(){if(typeof nAJAX._lock==='undefined'||nAJAX._lock===null){nAJAX._lock=document.getElementById('_running');if(typeof nAJAX._lock==='undefined'||nAJAX._lock===null){nAJAX._lock=document.getElementById('_lock')}}if(!nAJAX._lock){console.error("nAJAX._init not found '#_lock'!");throw"nAJAX.200";}};nAJAX.running_on=function(){if(!nAJAX._lock){nAJAX._init()}nAJAX._lock.style.display='block'};nAJAX.running_off=function(){if(!nAJAX._lock){nAJAX._init()}nAJAX._lock.style.display='none'};nAJAX.ajax_error=function(xmlhttp,textStatus,errorThrown){console.log('ajax_error:',xmlhttp,textStatus,errorThrown);nAJAX.running_off();if(xmlhttp.status===404){alert('Извините, данная ссылка в настоящее время не работает')}else{alert('Ошибка AJAX:\nStatus:'+xmlhttp.status+'\n'+xmlhttp.statusText)}nAJAX.running_off()}}());if(typeof $.blockUI==='function'){nCOMMON.blockUI=function(){ $.blockUI({message:'<i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>',baseZ:8000,css:{opacity:'0.75',color:'#000',border:'0px solid #aaa',backgroundColor:'transparent',cursor:'wait'}})};nCOMMON.unblockUI=$.unblockUI}else{nCOMMON.blockUI=nAJAX.running_on;nCOMMON.unblockUI=nAJAX.running_off}var nSHAVE={};nSHAVE.show=function(p_block,p_button){};nSHAVE.hide=function(p_block,p_button){};nSHAVE.init=function(){if(nSHAVE._inited){console.log('nSHAVE.init: Already initialized!');return}nSHAVE._inited=true; $('body').on('click','.shave-button-show',function(){let v_button=$(this);let v_block=v_button.parent();v_block.removeClass('shave-hide').addClass('shave-show');v_button.hide();v_block.find('div.shave-button-hide').show();if(v_block.data('height')){v_block.css('max-height','100%').height()}nSHAVE.show(v_block,v_button)}); $('body').on('click','.shave-button-hide',function(){let v_button=$(this);let v_block=v_button.parent();v_block.removeClass('shave-show').addClass('shave-hide');v_button.hide();v_block.find('div.shave-button-show').show();let v_heigh=v_block.data('height');if(v_heigh){v_block.css('max-height',v_heigh)}nSHAVE.hide(v_block,v_button)});let v_shaves=$('.shave');for(var v_i=0;v_i<v_shaves.length;v_i++){if($(v_shaves[v_i]).is('.shave-hide')){ $(v_shaves[v_i]).append($('<div/>',{Class:'shave-button-show'}).show()); $(v_shaves[v_i]).append($('<div/>',{Class:'shave-button-hide'}).hide())}else{ $(v_shaves[v_i]).append($('<div/>',{Class:'shave-button-show'}).hide()); $(v_shaves[v_i]).append($('<div/>',{Class:'shave-button-hide'}).show())}let v_heigh=$(v_shaves[v_i]).data('height');if(v_heigh){ $(v_shaves[v_i]).css('max-height',v_heigh)}}};