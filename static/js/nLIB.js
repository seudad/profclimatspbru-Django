var nLIB={src:'library',find:'',date_empty:'',date_undef:'????-??-?? ??:??',date_format:'yyyy.mm.dd HH:MM',_dummy_:null};nLIB.f_date_time=function(p_datetime){if(p_datetime===undefined){return nLIB.date_undef}if(p_datetime===null){return nLIB.date_empty}if(p_datetime<946670400){return nLIB.date_empty}return(new Date(p_datetime*1000)).format(nLIB.date_format)};nLIB.get_list=function(p_find,p_callback){ $.ajax({type:"POST",url:nCFG.ajax.get_path('file-list.pl'),data:{src:nLIB.src,find:nLIB.find},dataType:"json",error:nAJAX.ajax_error,success:function(p_res){if(parseInt(p_res.rc,10)!==0){nCOMMON.req_error(p_res);return}console.log('nLIB.get_list:',p_res);if(typeof p_callback==='function'){p_callback(p_res)}}})};nLIB.zebra=function(p_ref){var v_tbody=$(p_ref).find('tbody');v_tbody.removeClass('tr1').removeClass('tr2');v_tbody.find('tr:odd').addClass('tr1');v_tbody.find('tr:even').addClass('tr2')};nLIB.show=function(p_res){var v_tbody=$('#library-list tbody').empty();var v_no=0;for(var v_i=0;v_i<p_res.order.length;v_i++){var v_k=p_res.order[v_i];v_no++;var v_tr=$('<tr/>');v_tr.append($('<td/>',{text:v_no,Class:'tnum'}));var v_crt_datetime=Math.round(parseInt(v_k,10)/1000000);if(p_res.list[v_k]){v_tr.append($('<td/>',{text:''}));v_tr.append($('<td/>',{text:''}));v_tr.append($('<td/>',{text:p_res.list[v_k].FileName}));v_tr.append($('<td/>',{text:p_res.list[v_k].Title}))}else{v_tr.append($('<td/>',{text:''}));v_tr.append($('<td/>',{text:''}));v_tr.append($('<td/>',{text:''}));v_tr.append($('<td/>',{text:''}))}v_tbody.append(v_tr)}nLIB.zebra('#file-list')};nLIB.refresh=function(){nLIB.get_list({},function(p_res){p_res.order=[];for(var v_k in p_res.list){p_res.order.push(v_k)}console.log('nLIB.refresh:',p_res);nLIB.show(p_res)})};