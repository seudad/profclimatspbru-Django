var nDATA={};(function(){"use strict";nDATA.load=function(p_src,p_callback,p_error){ $.ajax({type:"POST",url:nCFG.ajax.get_path('data-load.pl'),data:{uid:nSESSION.uid,sid:nSESSION.sid,src:p_src},dataType:"json",error:nAJAX.ajax_error,success:function(p_res){if(Number(p_res.rc)!==0){nCOMMON.req_error(p_res);if(typeof p_error==='function'){p_error(p_res)}return}var v_src=p_src.split(',');var v_errors={msg:[]};if(v_src.length>1){for(var v_i=0;v_i<v_src.length;v_i++){if(Number(p_res.data[v_src[v_i]].rc)!==0){v_errors.msg.push(v_src[v_i]+'.ERRNO:'+p_res.data[v_src[v_i]].rc+'\n'+p_res.data[v_src[v_i]].msg)}}if(v_errors.msg.length){nCOMMON.req_error(v_errors);if(typeof p_error==='function'){p_error(p_res)}return}}if(typeof p_callback==='function'){p_callback(p_res)}}})};nDATA.get_okms=function(p_params,p_callback){ $.ajax({type:"POST",url:nCFG.ajax.get_path('okms_get.pl'),data:p_params,dataType:"json",error:nAJAX.ajax_error,success:function(p_res){if(parseInt(p_res.rc,10)!==0){nCOMMON.req_error(p_res);return}if(typeof p_callback==='function'){p_callback(p_res)}}})};nDATA.get_units=function(p_list,p_callback){ $.ajax({type:"POST",url:nCFG.ajax.get_path('data-get_units.pl'),data:{uid:nSESSION.uid,sid:nSESSION.sid,list:p_list.join(',')},dataType:"json",error:nAJAX.ajax_error,success:function(p_res){if(parseInt(p_res.rc,10)!==0){nCOMMON.req_error(p_res);return}if(typeof p_callback==='function'){p_callback(p_res)}}})};nDATA.get_сunits=function(p_callback,p_error){ $.ajax({type:"POST",url:nCFG.ajax.get_path('cunits-units.pl'),dataType:"json",error:nAJAX.ajax_error,success:function(p_res){if(Number(p_res.rc)!==0){nCOMMON.req_error(p_res);if(typeof p_error==='function'){p_error(p_res)}return}if(typeof p_callback==='function'){p_callback(p_res)}}})};nDATA.seqno=function(p_nm,p_callback){ $.ajax({type:"POST",url:nCFG.ajax.get_path('data-seqno.pl'),data:{uid:nSESSION.uid,sid:nSESSION.sid,nm:p_nm},dataType:"json",error:nAJAX.ajax_error,success:function(p_res){if(parseInt(p_res.rc,10)!==0){nCOMMON.req_error(p_res);return}if(typeof p_callback==='function'){p_callback(p_res)}}})};nDATA.save=function(p_dst,p_src,p_success,p_ajax_error){ $.ajax({type:"POST",url:nCFG.ajax.get_path('data-save.pl'),data:{uid:nSESSION.uid,sid:nSESSION.sid,dst:p_dst,data:JSON.stringify(p_src,null,'\t')},dataType:"json",error:(typeof p_ajax_error==='function'?p_ajax_error:nAJAX.ajax_error),success:function(p_res){if(parseInt(p_res.rc,10)!==0){nCOMMON.req_error(p_res);return}if(typeof p_success==='function'){p_success(p_res)}}})};nDATA.save_part=function(p_dst,p_path,p_data,p_success,p_ajax_error){ $.ajax({type:"POST",url:nCFG.ajax.get_path('data-save.pl'),data:{uid:nSESSION.uid,sid:nSESSION.sid,dst:p_dst,path:p_path,data:JSON.stringify(p_data,null,'\t')},dataType:"json",error:(typeof p_ajax_error==='function'?p_ajax_error:nAJAX.ajax_error),success:function(p_res){if(parseInt(p_res.rc,10)!==0){nCOMMON.req_error(p_res);return}if(typeof p_success==='function'){p_success(p_res)}}})};nDATA.get_item=function(p_ref,p_path){let v_item=p_ref;for(let v_i=0;v_i<p_path.length;v_i++){v_item=v_item[p_path[v_i]];if(v_item===undefined){break}}return v_item};nDATA.set_item=function(p_ref,p_path,p_value){let v_item=p_ref;for(let v_i=0;v_i<p_path.length;v_i++){v_item=(v_item[p_path[v_i]]?v_item[p_path[v_i]]:{})}v_item=p_value;return v_item};nDATA.isObj=function(p_obj){if(typeof(p_obj)!=='object'){return false}if(p_obj===null){return false}return true}}());