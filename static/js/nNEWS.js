"use strict";var nNEWS={data:[],_assign:false,_dummy_:null};nNEWS.text_unknow=function(p_no){return $('<div/>').append( $('<div/>',{Class:"news-title",text:''})).append( $('<div/>',{html:'<i>Извините, раздел пока отсутствует</i>'}))};nNEWS.text_show=function(p_no){if(nNEWS.text[p_no]!==undefined){if(nNEWS.text[p_no]!==undefined){if(nNEWS.data.list[p_no].url!==""){return $('<div/>').append( $('<a/>',{Class:"news-title",src:nNEWS.data.list[p_no].url,text:nCOMMON.funix2date(nNEWS.data.list[p_no].ctime)+' '+nNEWS.data.list[p_no].title})).append( $('<div/>',{html:nNEWS.data.list[p_no].text}))}return $('<div/>').append( $('<div/>',{Class:"news-title",text:nCOMMON.funix2date(nNEWS.data.list[p_no].mtime)+' '+nNEWS.data.list[p_no].title})).append( $('<div/>',{html:nNEWS.data.list[p_no].text}))}else{return nNEWS.text_unknow(p_no)}}return nNEWS.text_unknow(p_no)};nNEWS.text_get=function(p_id,p_callback){nDATA.load('news'+p_id,function(p_res){if(typeof(p_callback)==='function'){p_callback(p_res)}})};nNEWS.list_show=function(p_dest){var v_dest=$(p_dest).empty();var v_regexp=/(https?:\/\/[-0-9a-z._]+[0-9a-z][-0-9a-z._\/]*[-0-9a-z_\/](\?[0-9a-z.,_=&+]*[0-9a-z_=&+]|))/gi;for(var v_i=0;v_i<nNEWS.data.order.length;v_i++){var v_no=nNEWS.data.order[v_i];var v_news=$('<div/>',{Class:'news',id:'news'+v_no});var v_text=nNEWS.data.list[v_no].text;var v_title=nNEWS.data.list[v_no].title;v_title=v_title.replace(/</g,'&lt;');v_title=v_title.replace(/>/g,'&gt;');v_title=v_title.replace(v_regexp,'<a href="$1">$1</a>');v_text=v_text.replace(/</g,'&lt;');v_text=v_text.replace(/>/g,'&gt;');v_text=v_text.replace(v_regexp,'<a href="$1">$1</a>');v_text=v_text.replace(/\n/g,'<br>');v_news.append($('<div/>',{Class:"news-info",text:nCOMMON.funix2datetime(nNEWS.data.list[v_no].ctime)}));if(nNEWS.data.list[v_no].url!==''){v_news.append($('<a/>',{Class:"news-title",href:nNEWS.data.list[v_no].url,text:v_title,data:{no:v_no}}))}else{v_news.append($('<div/>',{Class:"news-title",html:v_title,data:{no:v_no}}))}v_news.append($('<div/>',{Class:"news-text",html:v_text,data:{no:v_no}}));v_news.appendTo(v_dest)}};nNEWS.list_get=function(p_callback){nDATA.load('news',function(p_res){nNEWS.data=p_res.data;if(typeof(p_callback)==='function'){p_callback(p_res)}})};nNEWS.init=function(p_dest){nNEWS.list_get(function(){nNEWS.list_show(p_dest)})};